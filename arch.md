# Архитектура CLI (Command-Line Interface)

## Обзор

Интерпретатор командной строки с циклом Read-Execute-Print Loop (REPL): чтение строки, разбор, выполнение команды, вывод результата.

## Компоненты (первая часть — без подстановок и пайпов)

### 1. REPL (Read-Execute-Print Loop)

- **Ввод**: чтение строки из stdin (например, `std::getline`).
- **Разбор**: передача строки в токенайзер → список аргументов.
- **Выполнение**: передача аргументов в исполнитель команд; получение кода возврата и потоков вывода/ошибок.
- **Вывод**: вывод stdout/stderr команды на экран; код возврата может использоваться для дальнейшей логики (в первой части — по усмотрению).

### 2. Токенайзер (Tokenizer / Lexer)

- **Вход**: одна строка — строка команды.
- **Выход**: вектор аргументов (`std::vector<std::string>`).
- **Правила**:
  - Пробелы между токенами разделяют аргументы.
  - Одинарные кавычки `'...'` и двойные `"..."`: всё внутри — один аргумент (в первой части без подстановок они ведут себя одинаково).
  - Закрывающая кавычка того же типа завершает аргумент.

### 3. Исполнитель команд (Executor)

- **Вход**: вектор аргументов (первый элемент — имя команды, остальные — аргументы).
- **Логика**:
  - Если имя команды — встроенная (`cat`, `echo`, `wc`, `pwd`, `exit`) → вызов соответствующей встроенной команды.
  - Иначе → запуск внешней программы с передачей окружения; stdout/stderr и код возврата — от процесса.
- **Выход**: код возврата; потоки вывода и ошибок выводятся в процессе выполнения (или буферизуются по необходимости).

### 4. Встроенные команды (Built-in commands)

| Команда | Описание | stdout | stderr | Код возврата |
|--------|----------|--------|--------|--------------|
| `cat <FILE>` | Содержимое файла | содержимое файла | ошибки (например, "файл не найден") | 0 при успехе, иначе ненулевой |
| `echo [args...]` | Аргументы на экран | аргументы через пробел | — | 0 |
| `wc <FILE>` | Строки, слова, байты | три числа: строки слова байты | ошибки | 0 при успехе, иначе ненулевой |
| `pwd` | Текущая директория | путь к текущей директории | — | 0 |
| `exit` | Выход из интерпретатора | — | — | завершение процесса REPL |

### 5. Запуск внешних программ (External runner)

- Поиск исполняемого файла по имени (PATH на Unix; на Windows — по расширениям и PATH).
- Запуск процесса с передачей текущего окружения (environment variables).
- Перенаправление stdout и stderr дочернего процесса в stdout и stderr интерпретатора (или их буферизованный вывод).
- Возврат кода завершения дочернего процесса вызывающему коду.

### 6. Потоки и коды возврата

- **Встроенные команды**: stdout/stderr и код возврата — на усмотрение реализации (см. таблицу выше).
- **Внешние процессы**: stdout, stderr и код возврата — те, что возвращает запущенная программа.

## Зависимости между компонентами

```
REPL
 │
 ├─→ Tokenizer  (строка → аргументы)
 │
 └─→ Executor   (аргументы → выполнение)
       │
       ├─→ Built-in: cat, echo, wc, pwd, exit
       └─→ External runner (env + stdout/stderr/exit code)
```

## Что не входит в первую часть

- Подстановки переменных (`$VAR`, `$x$y`).
- Присваивания в окружении (`NAME=value`).
- Пайпы (`cmd1 | cmd2`).
